<div class="figure-container"> 
{% if include.columns %}
<div class="figure-grid" style="--columns: {{ include.columns }};">
  {% for item in site.data[page.short-name][include.figure_key].figures %}
    {% assign anchor_id = "ex-" | append: item.figure.number %} {%-  comment -%} Create a unique ID for each anchor {%- endcomment -%}
    <a href="#{{ anchor_id }}" class="figure-grid-item-link"> {%- comment -%} Wrap the entire figure in an anchor tag {%- endcomment -%}
      <figure class="figure-grid-item" id="{{ anchor_id }}"> {%- comment -%} Add the ID to the figure itself {%- endcomment -%}
        <img src="{{ site.baseurl }}/{{ item.figure.url }}" alt="{{ item.figure.alt }}" 
             {% if item.figure.border %}class="with-border"{% endif %}
             style="width: {{ item.figure.scale | times: 100 }}%; height: auto;">
        {% if item.figure.caption %}
          <figcaption><span class="fig-number">Example {{ item.figure.number }}.</span> {{ item.figure.caption | markdownify  }}</figcaption>
        {% endif %}
      </figure>
    </a> 
  {% endfor %}

  {%- if site.data[page.short-name][include.figure_key].main_caption -%} 
    <div class="main-caption-wrapper"> 
      <figcaption><span class="fig-number">Example {{ site.data[page.short-name][include.figure_key].main_number }}.</span> {{ site.data[page.short-name][include.figure_key].main_caption | markdownify  }} </figcaption>
    </div>
  {%- endif -%}
</div>
{% else %}
<div class="figure-grid" style="--columns: 1;">
  {% for item in site.data[page.short-name][include.figure_key].figures %}
    {% assign anchor_id = "ex-" | append: item.figure.number %}
    <a href="#{{ anchor_id }}" class="figure-grid-item-link">
      <figure class="figure-grid-item" id="{{ anchor_id }}">
        <img src="{{ site.baseurl }}/{{ item.figure.url }}" alt="{{ item.figure.alt }}" 
             {% if item.figure.border %}class="with-border"{% endif %}
             style="width: {{ item.figure.scale | times: 100 }}%; height: auto;">
        {% if item.figure.caption %}
          <figcaption><span class="fig-number">Example {{ item.figure.number | markdownify  }}.</span> {{ item.figure.caption }}</figcaption>
        {% endif %}
      </figure>
    </a>
  {% endfor %}

  {%- if site.data[page.short-name][include.figure_key].main_caption -%} 
    <div class="main-caption-wrapper"> 
      <figcaption class="main-caption">{{ site.data[page.short-name][include.figure_key].main_caption | markdownify  }}</figcaption>
    </div>
  {%- endif -%}
</div>
{% endif %}
</div>
